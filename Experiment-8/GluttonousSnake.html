<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>GluttonousSnake</title>
</head>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", "PingFang SC", Arial, sans-serif;
        background-color: #D6E4E5;
        color: #333;
        padding: 0;
        margin: 0;
    }

    button {
        font-size: 1.1em;
        font-weight: bold;
        background-color: #D6E4E5;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        padding: 10px;
        margin: 20px auto;
        text-align: center;
        display: block;
    }

    #main {
        display: grid;
        grid-template-columns: auto auto;
        justify-content: center;
        padding: 20px;
    }

    #inputArea {
        background-color: #EFF5F5;
        border-radius: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin: 50px 0 0 50px;
        padding: 20px;
        height: fit-content;
        width: fit-content;
        float: left;
    }

    #gameArea {
        background-color: #EFF5F5;
        border-radius: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin: 50px;
        padding: 20px;
        height: fit-content;
        width: fit-content;
        float: left;
        white-space: nowrap;
    }

    #gameArea div {
        float: left;
        background-color: #eee;
    }
</style>
<body>
<div id="main">
    <div id="inputArea">
        <h1 style="text-align: center;">Ë¥™ÂêÉËõáÊ∏∏Êàè</h1>
        <h3 style="text-align: center;">ÂΩìÂâçÂæóÂàÜÔºö<span id="score">0</span></h3>
        <table>
            <tr>
                <td style="text-align: right;"><label for="speed">Âà∑Êñ∞ÈÄüÂ∫¶ÔºàmsÔºâÔºö</label></td>
                <td><input type="number" id="speed" value="800" min="1"
                           oninput="this.value = this.value.replace(/[^\d]/g, '')"></td>
            </tr>
            <tr>
                <td style="text-align: right;"><label for="cellLength">Ê†ºÂ≠êËæπÈïøÔºàpxÔºâÔºö</label></td>
                <td><input type="number" id="cellLength" value="64" min="1"
                           oninput="this.value = this.value.replace(/[^\d]/g, '')" onchange="resetGameArea()"></td>
            </tr>
            <tr>
                <td style="text-align: right;"><label for="cellMargin">Ê†ºÂ≠êÈó¥Ë∑ùÔºàpxÔºâÔºö</label></td>
                <td><input type="number" id="cellMargin" value="0" min="0"
                           oninput="this.value = this.value.replace(/[^\d]/g, '')" onchange="resetGameArea()"></td>
            </tr>
            <tr>
                <td style="text-align: right;"><label for="gameAreaWidth">ÂÆΩÂ∫¶ÔºàÊ†ºÔºâÔºö</label></td>
                <td><input type="number" id="gameAreaWidth" value="8" min="3"
                           oninput="this.value = this.value.replace(/[^\d]/g, '')" onchange="resetGameArea()"></td>
            </tr>
            <tr>
                <td style="text-align: right;"><label for="gameAreaHeight">È´òÂ∫¶ÔºàÊ†ºÔºâÔºö</label></td>
                <td><input type="number" id="gameAreaHeight" value="8" min="3"
                           oninput="this.value = this.value.replace(/[^\d]/g, '')" onchange="resetGameArea()"></td>
            </tr>
        </table>
        <button id="start" onclick="startGame()">ÂºÄÂßãÊ∏∏Êàè</button>
    </div>
    <div id="gameArea">
    </div>
</div>
</body>
<script>
    // ËäÇÁÇπÁ±ª
    class Node {
        constructor(type, row, col) {
            this.type = type;
            this.row = row;
            this.col = col;
            this.prev = null;
            this.next = null;
        }
    }

    // ÂèåÂêëÈìæË°®Á±ª
    class DoublyLinkedList {
        constructor() {
            this.head = null;
            this.tail = null;
            this.length = 0;
        }

        // ÈìæË°®Â∞æÈÉ®Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ËäÇÁÇπ
        append(node) {
            if (this.length === 0) {
                this.head = node;
                this.tail = node;
            } else {
                this.tail.next = node;
                node.prev = this.tail;
                this.tail = node;
            }
            this.length++;
        }

        // ÈìæË°®Â§¥ÈÉ®Ê∑ªÂä†‰∏Ä‰∏™Êñ∞ËäÇÁÇπ
        prepend(node) {
            if (this.length === 0) {
                this.head = node;
                this.tail = node;
            } else {
                this.head.prev = node;
                node.next = this.head;
                this.head = node;
            }
            this.length++;
        }

        // Âà†Èô§ÈìæË°®Â∞æÈÉ®ËäÇÁÇπ
        pop() {
            if (this.length === 0) {
                return null;
            }
            let node = this.tail;
            if (this.length === 1) {
                this.head = null;
                this.tail = null;
            } else {
                this.tail = this.tail.prev;
                this.tail.next = null;
            }
            this.length--;
            return node;
        }

    }

    // È£üÁâ©ËäÇÁÇπÁ±ª
    class FoodNode extends Node {
        constructor() {
            super();
        }

        init() {
            let gameAreaWidth = Number(document.getElementById("gameAreaWidth").value);
            let gameAreaHeight = Number(document.getElementById("gameAreaHeight").value);
            // Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®Á©∫ÁôΩÊ†ºÂ≠ê
            let empty = false;
            for (let i = 1; i <= gameAreaHeight; i++) {
                for (let j = 1; j <= gameAreaWidth; j++) {
                    if (checkCellEmpty(i, j)) {
                        empty = true;
                        break;
                    }
                }
                if (empty) {
                    break;
                }
            }
            if (!empty) {
                console.log("Ê≤°ÊúâÁ©∫ÁôΩÊ†ºÂ≠ê‰∫ÜÔºÅ");
                return null;
            }
            // Âú®Á©∫ÁôΩÊ†ºÂ≠ê‰∏≠ÈöèÊú∫ÁîüÊàêÈ£üÁâ©
            do {
                this.row = Math.floor(Math.random() * gameAreaHeight) + 1;
                this.col = Math.floor(Math.random() * gameAreaWidth) + 1;
            } while (!checkCellEmpty(this.row, this.col));
            this.type = "Food";
            return this;
        }

        display() {
            drawCanvas(document.getElementById("cell-" + this.row + "-" + this.col), "Food", 0);
        }
    }

    // Â¢ôËäÇÁÇπÁ±ª
    class WallNodes extends DoublyLinkedList {
        constructor() {
            super();
        }

        init() {
            let gameAreaWidth = Number(document.getElementById("gameAreaWidth").value);
            let gameAreaHeight = Number(document.getElementById("gameAreaHeight").value);
            //ËÆæÁΩÆÂ¢ôËäÇÁÇπÔºå‰ªéÂ∑¶‰∏äËßíÂºÄÂßãÈ°∫Êó∂ÈíàÂ≠òÂÇ®‰∏∫ÂèåÂêëÁéØÈìæ
            for (let i = 0; i < gameAreaWidth + 2; i++) {
                let node = new Node("Wall", 0, i);
                this.append(node);
            }
            for (let i = 1; i < gameAreaHeight + 2; i++) {
                let node = new Node("Wall", i, gameAreaWidth + 1);
                this.append(node);
            }
            for (let i = gameAreaWidth; i >= 0; i--) {
                let node = new Node("Wall", gameAreaHeight + 1, i);
                this.append(node);
            }
            for (let i = gameAreaHeight; i >= 1; i--) {
                let node = new Node("Wall", i, 0);
                this.append(node);
            }
            this.head.prev = this.tail;
            this.tail.next = this.head;
            return this;
        }

        display() {
            let gameAreaWidth = Number(document.getElementById("gameAreaWidth").value);
            let gameAreaHeight = Number(document.getElementById("gameAreaHeight").value);
            let currentNode = this.head;
            do {
                let cell = document.getElementById("cell-" + currentNode.row + "-" + currentNode.col);
                if (currentNode.row === 0 && currentNode.col === 0) {
                    drawCanvas(cell, "WallCorner", 270);
                } else if (currentNode.row === 0 && currentNode.col === gameAreaWidth + 1) {
                    drawCanvas(cell, "WallCorner", 0);
                } else if (currentNode.row === gameAreaHeight + 1 && currentNode.col === 0) {
                    drawCanvas(cell, "WallCorner", 180);
                } else if (currentNode.row === gameAreaHeight + 1 && currentNode.col === gameAreaWidth + 1) {
                    drawCanvas(cell, "WallCorner", 90);
                } else if (currentNode.row === 0) {
                    drawCanvas(cell, "Wall", 0);
                } else if (currentNode.col === 0) {
                    drawCanvas(cell, "Wall", 270);
                } else if (currentNode.row === gameAreaHeight + 1) {
                    drawCanvas(cell, "Wall", 180);
                } else if (currentNode.col === gameAreaWidth + 1) {
                    drawCanvas(cell, "Wall", 90);
                }
                currentNode = currentNode.next;
            } while (currentNode !== this.head)
        }
    }

    // ËõáËäÇÁÇπÁ±ª
    class SnakeList extends DoublyLinkedList {
        constructor() {
            super();
            this.headDirection = null;
        }

        init() {
            let body = new Node("Snake", 3, 1);
            this.append(body);
            body = new Node("Snake", 2, 1);
            this.append(body);
            body = new Node("Snake", 1, 1);
            this.append(body);
            body = new Node("Snake", 1, 2);
            this.append(body);
            body = new Node("Snake", 2, 2);
            this.append(body);
            this.headDirection = "down";
            return this;
        }

        display() {
            let currentNode = this.head;
            while (currentNode !== null) {
                let cell = document.getElementById("cell-" + currentNode.row + "-" + currentNode.col);
                let prevNode = currentNode.prev;
                let nextNode = currentNode.next;
                if (currentNode === this.head) {
                    if (currentNode.row === nextNode.row) {
                        if (currentNode.col < nextNode.col) {
                            drawCanvas(cell, "SnakeHead", 270);
                        } else {
                            drawCanvas(cell, "SnakeHead", 90);
                        }
                    } else {
                        if (currentNode.row < nextNode.row) {
                            drawCanvas(cell, "SnakeHead", 0);
                        } else {
                            drawCanvas(cell, "SnakeHead", 180);
                        }
                    }
                } else if (currentNode === this.tail) {
                    if (currentNode.row === prevNode.row) {
                        if (currentNode.col > prevNode.col) {
                            drawCanvas(cell, "SnakeTail", 270);
                        } else {
                            drawCanvas(cell, "SnakeTail", 90);
                        }
                    } else {
                        if (currentNode.row > prevNode.row) {
                            drawCanvas(cell, "SnakeTail", 0);
                        } else {
                            drawCanvas(cell, "SnakeTail", 180);
                        }
                    }
                } else {
                    if (currentNode.row === prevNode.row && currentNode.row === nextNode.row) {
                        if (currentNode.col > prevNode.col) {
                            drawCanvas(cell, "SnakeBodyStraight", 270);
                        } else {
                            drawCanvas(cell, "SnakeBodyStraight", 90);
                        }
                    } else if (currentNode.col === prevNode.col && currentNode.col === nextNode.col) {
                        if (currentNode.row < nextNode.row) {
                            drawCanvas(cell, "SnakeBodyStraight", 0);
                        } else {
                            drawCanvas(cell, "SnakeBodyStraight", 180);
                        }
                    } else {
                        drawCanvas(cell, "SnakeBodyBend", 0);
                        let canvas = cell.children[0];
                        if (currentNode.row === prevNode.row) {
                            if (currentNode.col > prevNode.col) {
                                if (currentNode.row < nextNode.row) {
                                    canvas.style.transform = "rotate(0deg) rotateX(0deg)";
                                } else {
                                    canvas.style.transform = "rotate(0deg) rotateX(180deg)";
                                }
                            } else {
                                if (currentNode.row > nextNode.row) {
                                    canvas.style.transform = "rotate(180deg) rotateX(0deg)";
                                } else {
                                    canvas.style.transform = "rotate(180deg) rotateX(180deg)";
                                }
                            }
                        } else if (currentNode.col === prevNode.col) {
                            if (currentNode.row > prevNode.row) {
                                if (currentNode.col > nextNode.col) {
                                    canvas.style.transform = "rotate(90deg) rotateX(0deg)";
                                } else {
                                    canvas.style.transform = "rotate(90deg) rotateX(180deg)";
                                }
                            } else {
                                if (currentNode.col < nextNode.col) {
                                    canvas.style.transform = "rotate(270deg) rotateX(0deg)";
                                } else {
                                    canvas.style.transform = "rotate(270deg) rotateX(180deg)";
                                }
                            }
                        }
                    }
                }
                currentNode = currentNode.next;
            }
        }

        move(targetDirection) {
            let tempNode = this.pop();
            // Ê∏ÖÁ©∫tempNodeÊâÄÂú®ÁöÑÊ†ºÂ≠ê
            document.getElementById("cell-" + tempNode.row + "-" + tempNode.col).innerHTML = "";


        }
    }

    // ÈáçÊñ∞ËÆæÁΩÆÊ∏∏ÊàèÂå∫Âüü
    function resetGameArea() {
        let cellLength = Number(document.getElementById("cellLength").value);
        let gameAreaWidth = Number(document.getElementById("gameAreaWidth").value);
        let gameAreaHeight = Number(document.getElementById("gameAreaHeight").value);
        let gameArea = document.getElementById("gameArea");
        // ËæìÂÖ•Ê†°È™å
        if (gameAreaWidth < 3) {
            alert("ÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶ÂøÖÈ°ªÂ§ß‰∫éÁ≠â‰∫é3ÔºÅ");
            document.getElementById("gameAreaWidth").value = 3;
            gameAreaWidth = 3;
        } else if (gameAreaHeight < 3) {
            alert("ÂÆΩÂ∫¶ÂíåÈ´òÂ∫¶ÂøÖÈ°ªÂ§ß‰∫éÁ≠â‰∫é3ÔºÅ");
            document.getElementById("gameAreaHeight").value = 3;
            gameAreaHeight = 3;
        }
        // Ê∏ÖÁ©∫ÂéüÊúâÂÜÖÂÆπ
        gameArea.innerHTML = "";
        // Â°´ÂÖÖÊ†ºÂ≠ê
        let table = document.createElement("table");
        table.style.borderSpacing = document.getElementById("cellMargin").value + "px";
        for (let i = 0; i < gameAreaHeight + 2; i++) {
            let row = document.createElement("tr");
            for (let j = 0; j < gameAreaWidth + 2; j++) {
                let cell = document.createElement("td");
                cell.id = "cell-" + i + "-" + j;
                cell.style.width = cellLength + "px";
                cell.style.height = cellLength + "px";
                cell.style.padding = "0";
                // ËÉåÊôØËÆæÁΩÆ‰∏∫Ê£ãÁõòËâ≤
                if (i % 2 === 0 && j % 2 === 0 || i % 2 === 1 && j % 2 === 1) {
                    cell.style.backgroundColor = "#eee";
                } else {
                    cell.style.backgroundColor = "#ddd";
                }
                row.appendChild(cell);
            }
            table.appendChild(row);
        }
        gameArea.appendChild(table);
        // ÁªòÂà∂Â¢ô
        let wallNodes = new WallNodes();
        wallNodes.init();
        wallNodes.display();
    }

    resetGameArea(); // ËΩΩÂÖ•È°µÈù¢ÂêéÁ´ãÂç≥ÂàùÂßãÂåñÊ∏∏ÊàèÂå∫Âüü‰∏ÄÊ¨°

    // Ê£ÄÊü•Ê†ºÂ≠êÊòØÂê¶‰∏∫Á©∫
    function checkCellEmpty(row, col) {
        return document.getElementById("cell-" + row + "-" + col).children.length === 0;
    }

    // Ê£ÄÊü•Ê†ºÂ≠êÊòØÂê¶‰∏∫È£üÁâ©
    function checkCellFood(row, col) {
        return document.getElementById("cell-" + row + "-" + col).children[0].tagName.toUpperCase() === "DIV";
    }

    // ÈÄÇÈÖçÈ´òÊ∏ÖÂ±è
    function createHDCanvas(canvas, l, ratio) {
        canvas.width = l * ratio; // ÂÆûÈôÖÊ∏≤ÊüìÂÉèÁ¥†
        canvas.height = l * ratio; // ÂÆûÈôÖÊ∏≤ÊüìÂÉèÁ¥†
        canvas.style.width = `${l}px`; // ÊéßÂà∂ÊòæÁ§∫Â§ßÂ∞è
        canvas.style.height = `${l}px`; // ÊéßÂà∂ÊòæÁ§∫Â§ßÂ∞è
        return canvas;
    }

    // canvasÁªòÂà∂
    function drawCanvas(cell, type, rotation) {
        cell.innerHTML = "";  // Ê∏ÖÈô§ÂéüÊúâÂÜÖÂÆπ
        let ratio = window.devicePixelRatio || 1;
        let cellLength = Number(document.getElementById("cellLength").value);
        if (type === "Food") {  // È£üÁâ©‰∏çÈúÄË¶ÅÁªòÂà∂ÔºåÁõ¥Êé•‰ΩøÁî® emoji
            let div = document.createElement("div");
            div.style.width = cellLength + "px";
            div.style.height = cellLength + "px";
            div.style.fontSize = cellLength * 0.8 + "px";
            div.style.lineHeight = cellLength + "px";
            div.style.backgroundColor = "rgba(0,0,0,0)";
            div.style.display = "flex";
            div.style.alignContent = "center";
            div.style.justifyContent = "center";
            div.style.margin = 0;
            div.style.padding = 0;
            let foods = ["üçé", "üçä", "üçã", "üçå", "üçâ", "üçá", "üçì", "üçí", "üçë", "üçç", "ü´ê", "üçï", "üçî", "üåÆ", "üç∞",
                "ü•û", "ü•ê", "üç£", "üç§", "ü•ì", "ü•©", "üçó", "üçñ", "üßã", "ü•§", "üê≠"];
            div.innerHTML = foods[Math.floor(Math.random() * foods.length)];
            div.style.transform = `rotate(${rotation}deg)`;  // ÊóãËΩ¨
            cell.appendChild(div);
            return;
        }
        let canvas = document.createElement("canvas");
        canvas.style.display = "block";
        canvas.style.padding = "0";
        canvas.style.margin = "0";
        canvas = createHDCanvas(canvas, cellLength, ratio);
        let ctx = canvas.getContext("2d");
        let pl = cellLength * ratio / 16;  // PixelLength Ê†áÂáÜÂÉèÁ¥†ÈïøÂ∫¶
        function PL(n) {
            return n * pl;
        }

        // ÁªòÂà∂Â¢ôÈù¢
        if (type === "Wall") {
            // Â°´ÂÖÖËÉåÊôØ
            ctx.fillStyle = "#45283C";
            ctx.fillRect(PL(0), PL(0), PL(16), PL(16));
            // ÁªòÂà∂Á†ñÂùó
            ctx.fillStyle = "#8F563B";
            ctx.fillRect(PL(0), PL(1), PL(4), PL(3));
            ctx.fillRect(PL(5), PL(1), PL(7), PL(3));
            ctx.fillRect(PL(13), PL(1), PL(3), PL(3));
            ctx.fillRect(PL(1), PL(5), PL(7), PL(3));
            ctx.fillRect(PL(9), PL(5), PL(7), PL(3));
            ctx.fillRect(PL(0), PL(9), PL(4), PL(3));
            ctx.fillRect(PL(5), PL(9), PL(7), PL(3));
            ctx.fillRect(PL(13), PL(9), PL(3), PL(3));
            ctx.fillRect(PL(1), PL(13), PL(7), PL(3));
            ctx.fillRect(PL(9), PL(13), PL(7), PL(3));
        }
        // ÁªòÂà∂Â¢ôËßí
        if (type === "WallCorner") {
            // Â°´ÂÖÖËÉåÊôØ
            ctx.fillStyle = "#45283C";
            ctx.fillRect(PL(0), PL(0), PL(16), PL(16));
            // ÁªòÂà∂Á†ñÂùó
            ctx.fillStyle = "#8F563B";
            ctx.fillRect(PL(0), PL(1), PL(4), PL(3));
            ctx.fillRect(PL(5), PL(1), PL(7), PL(3));
            ctx.fillRect(PL(13), PL(1), PL(2), PL(3));
            ctx.fillRect(PL(12), PL(5), PL(3), PL(7));
            ctx.fillRect(PL(12), PL(13), PL(3), PL(3));
            ctx.fillRect(PL(1), PL(5), PL(7), PL(3));
            ctx.fillRect(PL(9), PL(5), PL(2), PL(3));
            ctx.fillRect(PL(8), PL(9), PL(3), PL(7));
            ctx.fillRect(PL(0), PL(9), PL(4), PL(3));
            ctx.fillRect(PL(5), PL(9), PL(2), PL(3));
            ctx.fillRect(PL(4), PL(13), PL(3), PL(3));
            ctx.fillRect(PL(1), PL(13), PL(2), PL(3));
        }
        // ÁªòÂà∂ËõáÂ§¥
        if (type === "SnakeHead") {
            // Ê∑±Ëâ≤ÊèèËæπ
            ctx.fillStyle = "#222034";
            ctx.fillRect(PL(5), PL(2), PL(6), PL(1));
            ctx.fillRect(PL(4), PL(3), PL(8), PL(1));
            ctx.fillRect(PL(3), PL(4), PL(10), PL(1));
            ctx.fillRect(PL(2), PL(5), PL(12), PL(11));
            ctx.fillRect(PL(1), PL(7), PL(14), PL(7));
            ctx.fillRect(PL(0), PL(9), PL(16), PL(4));
            // Á∫¢Ëâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#D95763";
            ctx.fillRect(PL(7), PL(0), PL(2), PL(2));
            // ÊµÖÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#99E550";
            ctx.fillRect(PL(5), PL(3), PL(6), PL(1));
            ctx.fillRect(PL(4), PL(4), PL(8), PL(1));
            ctx.fillRect(PL(3), PL(5), PL(10), PL(11));
            ctx.fillRect(PL(2), PL(7), PL(12), PL(7));
            ctx.fillRect(PL(1), PL(9), PL(14), PL(4));
            // ÁôΩËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#FFFFFF";
            ctx.fillRect(PL(4), PL(9), PL(2), PL(4));
            ctx.fillRect(PL(3), PL(10), PL(4), PL(2));
            ctx.fillRect(PL(10), PL(9), PL(2), PL(4));
            ctx.fillRect(PL(9), PL(10), PL(4), PL(2));
            // Ê∑±Ëâ≤ÁªÜËäÇ
            ctx.fillStyle = "#222034";
            ctx.fillRect(PL(6), PL(5), PL(1), PL(1));
            ctx.fillRect(PL(9), PL(5), PL(1), PL(1));
            ctx.fillRect(PL(4), PL(10), PL(1), PL(1));
            ctx.fillRect(PL(10), PL(10), PL(1), PL(1));
        }
        // ÁªòÂà∂Áõ¥ËõáË∫´
        if (type === "SnakeBodyStraight") {
            // Ê∑±Ëâ≤ÊèèËæπ
            ctx.fillStyle = "#222034";
            ctx.fillRect(PL(2), PL(0), PL(12), PL(1));
            ctx.fillRect(PL(1), PL(1), PL(12), PL(2));
            ctx.fillRect(PL(0), PL(3), PL(12), PL(2));
            ctx.fillRect(PL(1), PL(5), PL(12), PL(2));
            ctx.fillRect(PL(2), PL(7), PL(12), PL(2));
            ctx.fillRect(PL(3), PL(9), PL(12), PL(2));
            ctx.fillRect(PL(4), PL(11), PL(12), PL(2));
            ctx.fillRect(PL(3), PL(13), PL(12), PL(2));
            ctx.fillRect(PL(2), PL(15), PL(12), PL(1));
            // Ê∑±ÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#37946E";
            ctx.fillRect(PL(3), PL(0), PL(10), PL(1));
            ctx.fillRect(PL(2), PL(1), PL(10), PL(2));
            ctx.fillRect(PL(1), PL(3), PL(10), PL(2));
            ctx.fillRect(PL(2), PL(5), PL(10), PL(2));
            ctx.fillRect(PL(3), PL(7), PL(10), PL(1));
            // ÊµÖÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#99E550";
            ctx.fillRect(PL(3), PL(8), PL(10), PL(1));
            ctx.fillRect(PL(4), PL(9), PL(10), PL(2));
            ctx.fillRect(PL(5), PL(11), PL(10), PL(2));
            ctx.fillRect(PL(4), PL(13), PL(10), PL(2));
            ctx.fillRect(PL(3), PL(15), PL(10), PL(1));
        }
        // ÁªòÂà∂ÂºØËõáË∫´
        if (type === "SnakeBodyBend") {
            // Ê∑±Ëâ≤ÊèèËæπ
            ctx.fillStyle = "#222034";
            ctx.fillRect(PL(0), PL(2), PL(1), PL(1));
            ctx.fillRect(PL(1), PL(1), PL(3), PL(1));
            ctx.fillRect(PL(4), PL(0), PL(4), PL(1));
            ctx.fillRect(PL(8), PL(1), PL(3), PL(1));
            ctx.fillRect(PL(11), PL(2), PL(2), PL(1));
            ctx.fillRect(PL(13), PL(3), PL(1), PL(2));
            ctx.fillRect(PL(14), PL(5), PL(1), PL(3));
            ctx.fillRect(PL(15), PL(8), PL(1), PL(4));
            ctx.fillRect(PL(14), PL(12), PL(1), PL(3));
            ctx.fillRect(PL(13), PL(15), PL(1), PL(1));
            ctx.fillRect(PL(0), PL(13), PL(1), PL(1));
            ctx.fillRect(PL(1), PL(12), PL(2), PL(1));
            ctx.fillRect(PL(3), PL(13), PL(1), PL(2));
            ctx.fillRect(PL(2), PL(15), PL(1), PL(1));
            // ÊµÖÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#99E550";
            ctx.fillRect(PL(0), PL(3), PL(13), PL(2));
            ctx.fillRect(PL(0), PL(5), PL(14), PL(3));
            ctx.fillRect(PL(0), PL(8), PL(15), PL(4));
            ctx.fillRect(PL(3), PL(12), PL(11), PL(1));
            ctx.fillRect(PL(4), PL(13), PL(10), PL(2));
            ctx.fillRect(PL(3), PL(15), PL(10), PL(1));
            // Ê∑±ÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#37946E";
            ctx.fillRect(PL(4), PL(1), PL(4), PL(1));
            ctx.fillRect(PL(1), PL(2), PL(10), PL(1));
            ctx.fillRect(PL(0), PL(3), PL(13), PL(1));
            ctx.fillRect(PL(0), PL(4), PL(12), PL(1));
            ctx.fillRect(PL(0), PL(5), PL(11), PL(1));
            ctx.fillRect(PL(0), PL(6), PL(10), PL(1));
            ctx.fillRect(PL(0), PL(7), PL(9), PL(1));
            ctx.fillRect(PL(0), PL(8), PL(8), PL(1));
            ctx.fillRect(PL(0), PL(9), PL(7), PL(1));
            ctx.fillRect(PL(0), PL(10), PL(6), PL(1));
            ctx.fillRect(PL(0), PL(11), PL(5), PL(1));
            ctx.fillRect(PL(0), PL(12), PL(1), PL(1));
            ctx.fillRect(PL(3), PL(12), PL(1), PL(1));
        }
        // ÁªòÂà∂ËõáÂ∞æ
        if (type === "SnakeTail") {
            // Ê∑±Ëâ≤ÊèèËæπ
            ctx.fillStyle = "#222034";
            ctx.fillRect(PL(2), PL(0), PL(1), PL(2));
            ctx.fillRect(PL(1), PL(2), PL(1), PL(4));
            ctx.fillRect(PL(2), PL(6), PL(1), PL(3));
            ctx.fillRect(PL(3), PL(9), PL(1), PL(2));
            ctx.fillRect(PL(4), PL(11), PL(1), PL(1));
            ctx.fillRect(PL(5), PL(12), PL(1), PL(1));
            ctx.fillRect(PL(6), PL(13), PL(1), PL(2));
            ctx.fillRect(PL(7), PL(15), PL(1), PL(1));
            ctx.fillRect(PL(8), PL(10), PL(1), PL(5));
            ctx.fillRect(PL(9), PL(6), PL(1), PL(4));
            ctx.fillRect(PL(10), PL(3), PL(1), PL(3));
            ctx.fillRect(PL(11), PL(2), PL(1), PL(1));
            ctx.fillRect(PL(12), PL(1), PL(1), PL(1));
            ctx.fillRect(PL(13), PL(0), PL(1), PL(1));
            // Ê∑±ÁªøËâ≤ÈÉ®ÂàÜ
            ctx.fillStyle = "#37946E";
            ctx.fillRect(PL(3), PL(0), PL(10), PL(1));
            ctx.fillRect(PL(3), PL(1), PL(9), PL(1));
            ctx.fillRect(PL(2), PL(2), PL(9), PL(1));
            ctx.fillRect(PL(2), PL(3), PL(8), PL(3));
            ctx.fillRect(PL(3), PL(6), PL(6), PL(3));
            ctx.fillRect(PL(4), PL(9), PL(5), PL(1));
            ctx.fillRect(PL(4), PL(10), PL(4), PL(1));
            ctx.fillRect(PL(5), PL(11), PL(3), PL(1));
            ctx.fillRect(PL(6), PL(12), PL(2), PL(1));
            ctx.fillRect(PL(7), PL(13), PL(1), PL(2));
        }
        canvas.style.transform = `rotate(${rotation}deg)`;  // ÊóãËΩ¨
        cell.appendChild(canvas);
    }

    // ÂºÄÂßãÊ∏∏Êàè
    function startGame() {
        // Á¶ÅÊ≠¢‰øÆÊîπÊ∏∏ÊàèÂå∫ÂüüËÆæÁΩÆ
        document.getElementById("speed").disabled = true;
        document.getElementById("cellLength").disabled = true;
        document.getElementById("cellMargin").disabled = true;
        document.getElementById("gameAreaWidth").disabled = true;
        document.getElementById("gameAreaHeight").disabled = true;
        // ÂàõÂª∫Ëõá
        let snake = new SnakeList();
        snake.init();
        snake.display();
        // ÂàõÂª∫È£üÁâ©
        let food = new FoodNode();
        food.init();
        food.display();
        // ‰∏¥Êó∂ÂèòÈáèÂ≠òÂÇ®ÁõÆÊ†áÊñπÂêë
        let targetDirection = null;
        // ÈîÆÁõò‰∫ã‰ª∂ÁõëÂê¨
        document.onkeydown = function (event) {
            let e = event || window.event || arguments.callee.caller.arguments[0];
            if (e && e.keyCode === 37) {  // Â∑¶
                targetDirection = "left";
            }
            if (e && e.keyCode === 38) {  // ‰∏ä
                targetDirection = "up";
            }
            if (e && e.keyCode === 39) {  // Âè≥
                targetDirection = "right";
            }
            if (e && e.keyCode === 40) {  // ‰∏ã
                targetDirection = "down";
            }
        };
        // ËõáÁßªÂä®
        snake.move(targetDirection);
        snake.display();

    }
</script>
</html>